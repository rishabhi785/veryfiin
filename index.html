<!DOCTYPE html>
<html>
<head>
    <title>Device Verification</title>
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
</head>
<body>
    <h1>Device Verification</h1>
    <p>Please wait while we verify your device...</p>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id');
        
        // Get fingerprint
        FingerprintJS.load()
            .then(fp => fp.get())
            .then(result => {
                const fingerprint = result.visitorId;
                
                // Send to backend
                fetch('https://your-flask-backend.herokuapp.com/verify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user_id: userId,
                        fingerprint: fingerprint
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if(data.success) {
                        alert("Device verified successfully!");
                        // Close the window after 2 seconds
                        setTimeout(() => window.close(), 2000);
                    }
                });
            });
    </script>
</body>
</html>
